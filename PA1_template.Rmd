---
title: "Activity Monitoring Data Analysis"
output: html_document
---

### Loading the activity data 


1. Loading the file "activity.csv" from the current working directory

```{r echo = TRUE}
activity <- read.csv("activity.csv", header = TRUE)
```

### Mean total number of steps taken per day
*The missing values (NA) are ignored.*

1. Histogram of the total number of steps taken each day
```{r, echo = TRUE}
total.steps.per.day <- aggregate(steps ~ date, activity, sum)
library(ggplot2)
h <- ggplot(total.steps.per.day, aes(date, steps)) +
  geom_bar(stat = "identity", fill = "lightblue") +
  labs(x = "Date", y = "Number of Steps", title = "Number of Steps Per Day") 
theme_new <- theme_set(theme_bw())
theme_new <- theme_update(axis.text.x = element_text(angle = 90, size = 7))
h
```

2. Mean and Median total number of steps taken per day

```{r, echo = TRUE}
mean.total.steps.per.day <- mean(total.steps.per.day$steps)
median.total.steps.per.day <- median(total.steps.per.day$steps)
```
- The Mean of the total number of steps taken per day is **`r format(mean.total.steps.per.day,big.mark=",")`**
- The Median of the total number of steps taken per day is **`r format(median.total.steps.per.day, big.mark=",")`**

### Daily activity pattern
1. Time series average number of steps taken by 5 minutes, and averaged across all days

```{r, echo=TRUE}
activity$interval <- as.factor(activity$interval)
average.steps.by.5min <- aggregate(steps ~ interval, activity, mean)
l <- ggplot(average.steps.by.5min, aes(interval, steps)) + 
  geom_line(aes(group=1)) +
  geom_hline(yintercept = mean(activity[is.na(activity$steps)==FALSE,]$steps), color = "red") +
  scale_x_discrete(breaks = seq(0,2355,by=30))
l
```

2. Period with highest average
```{r echo=TRUE}
highest.5min.average <- head(average.steps.by.5min[order(-average.steps.by.5min$steps),], 1)
```
- The 5-minute interval, on average across all the days in the dataset which contains the maximum number of steps is the minute **`r as.character(highest.5min.average$interval)`** with an average of `r format(highest.5min.average$steps, big.mark=",")` steps.